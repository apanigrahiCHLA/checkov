name: Find URLs in Codebase



on:

  push:

    branches: [ main, master, develop ]

  pull_request:

    branches: [ main, master, develop ]

  workflow_dispatch:



jobs:

  find-urls:

    runs-on: ubuntu-latest

    

    steps:

    - name: Checkout code

      uses: actions/checkout@v4



    - name: Find all URLs

      run: |

        echo "# 🔍 URLs Found in Codebase" >> $GITHUB_STEP_SUMMARY

        echo "" >> $GITHUB_STEP_SUMMARY

        

        # Create CSV report

        echo "File,Line,URL,Type" > urls_report.csv

        

        # Find HTTP/HTTPS URLs

        echo "## HTTP/HTTPS URLs:" >> $GITHUB_STEP_SUMMARY

        echo "" >> $GITHUB_STEP_SUMMARY

        

        grep -r -n -E "https?://[^\s\"'<>)\]};,]+" . \

          --exclude-dir=.git \

          --exclude-dir=node_modules \

          --exclude-dir=.github \

          --exclude-dir=target \

          --exclude-dir=build \

          --exclude-dir=dist \

          --exclude="*.min.js" \

          --exclude="*.map" | while IFS=: read -r file line content; do

          url=$(echo "$content" | grep -oE "https?://[^\s\"'<>)\]};,]+")

          echo "$file,$line,$url,HTTP/HTTPS" >> urls_report.csv

          echo "- \`$file:$line\` → $url" >> $GITHUB_STEP_SUMMARY

        done

        

        echo "" >> $GITHUB_STEP_SUMMARY

        echo "## WWW URLs:" >> $GITHUB_STEP_SUMMARY

        echo "" >> $GITHUB_STEP_SUMMARY

        

        # Find www URLs

        grep -r -n -E "www\.[^\s\"'<>)\]};,]+" . \

          --exclude-dir=.git \

          --exclude-dir=node_modules \

          --exclude-dir=.github \

          --exclude-dir=target \

          --exclude-dir=build \

          --exclude-dir=dist \

          --exclude="*.min.js" \

          --exclude="*.map" | while IFS=: read -r file line content; do

          url=$(echo "$content" | grep -oE "www\.[^\s\"'<>)\]};,]+")

          echo "$file,$line,$url,WWW" >> urls_report.csv

          echo "- \`$file:$line\` → $url" >> $GITHUB_STEP_SUMMARY

        done

        

        # Count totals

        TOTAL_URLS=$(wc -l < urls_report.csv)

        TOTAL_URLS=$((TOTAL_URLS - 1)) # Subtract header row

        

        echo "" >> $GITHUB_STEP_SUMMARY

        echo "## Summary" >> $GITHUB_STEP_SUMMARY

        echo "**Total URLs found: $TOTAL_URLS**" >> $GITHUB_STEP_SUMMARY

        echo "" >> $GITHUB_STEP_SUMMARY

        echo "📥 Download the complete CSV report from the Actions artifacts below." >> $GITHUB_STEP_SUMMARY



    - name: Upload URL Report

      uses: actions/upload-artifact@v4

      with:

        name: urls-report

        path: urls_report.csv

        retention-days: 30
